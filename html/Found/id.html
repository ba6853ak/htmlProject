<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>아이디 찾기</title>
    <link rel="stylesheet" href="../../Css/find.css">
</head>
<body>

<div class="container">
    <div class="tabs">
        <div id="find-id-tab" class="tab active">아이디 찾기</div>
        <div id="find-pw-tab" class="tab">비밀번호 찾기</div>
    </div>
    <div id="find-id-content">
        <div class="input-group">
            <div class="input-wrapper">
                <input type="text" id="input-field" placeholder="가입된 이메일">
                <input type="button" id="check-email-button" value="확인">
            </div>
        </div>
        <div id="new-field-container"></div>
        <div id="timer"></div> <!-- 타이머 표시할 div -->
        <div class="error-message" id="error-message"></div>
        <button id="find-id-button">아이디 찾기</button>
    </div>
    <div class="instructions" id="instructions">
        <p>※ 가입된 아이디가 있을 경우, 입력하신 이메일로 아이디를 안내해 드립니다.</p>
        <p>※ 만약 이메일이 오지 않는다면, 스팸 편지함으로 이동하지 않았는지 확인해주세요.</p>
        <p>※ 이메일 서비스 제공자 사정에 의해 즉시 도착하지 않을 수 있으니, 최대 30분 정도 기다리신 후 다시 시도해주세요.</p>
    </div>
</div>

<script>
    const inputField = document.getElementById('input-field');
    const checkEmailButton = document.getElementById('check-email-button');
    const errorMessage = document.getElementById('error-message');
    const newFieldContainer = document.getElementById('new-field-container');
    const timerElement = document.getElementById('timer');

    function redirectToFindPw() {
        window.location.href = 'pw.html';
    }

    document.getElementById('find-pw-tab').addEventListener('click', redirectToFindPw);

    checkEmailButton.addEventListener('click', () => {
        const emailValue = inputField.value.trim();

        if (emailValue === '') {
            errorMessage.textContent = '이메일을 입력해 주세요';
            errorMessage.style.display = 'block';
        } else if (!emailValue.includes('@')) {
            errorMessage.textContent = '유효한 이메일 주소를 입력해 주세요';
            errorMessage.style.display = 'block';
        } else {
            // 이메일 유효성 확인이 완료되었을 때
            errorMessage.style.display = 'none';
            
            // 이메일 입력 창 비활성화
            inputField.disabled = true;
            checkEmailButton.style.display = 'none'; // 버튼 숨기기

           

            // 새로운 입력 칸 생성
            if (!document.getElementById('new-field')) {
                const newField = document.createElement('div');
                newField.classList.add('input-group');
                newField.innerHTML = '<input type="text" id="new-field" placeholder="새로운 입력란">';
                newFieldContainer.appendChild(newField);

                // 타이머 시작
                startTimer(180); // 3분 (180초)
            }
            alert('메일함을 확인해 주세요');
        }
    });

    function startTimer(duration) {
        let timeRemaining = duration;
        const timerInterval = setInterval(() => {
            let minutes = Math.floor(timeRemaining / 60);
            let seconds = timeRemaining % 60;
            seconds = seconds < 10 ? '0' + seconds : seconds; // 두 자리 숫자로 표시

            timerElement.textContent = `남은 시간: ${minutes}:${seconds}`;
            timeRemaining--;

            if (timeRemaining < 0) {
                clearInterval(timerInterval);
                timerElement.textContent = '시간이 만료되었습니다.';
                document.getElementById('new-field').disabled = true; // 타이머 만료 후 새 입력란 비활성화
            }
        }, 1000);
    }
</script>

</body>
</html>
